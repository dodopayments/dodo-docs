---
title: "Microsoft Teams"
description: "Send Dodo Payments notifications to Microsoft Teams channels with rich Adaptive Cards."
icon: "microsoft"
---

## Introduction

Keep your business team in the loop with real-time payment notifications in Microsoft Teams. The integration delivers payment events as rich Adaptive Cards‚Äîperfect for enterprise environments where Teams is the primary collaboration tool.

<Info>
This guide assumes you have admin access to create webhooks in your Microsoft Teams workspace.
</Info>

## Getting Started

<Steps>
<Step title="Open the Webhook Section">
  In your Dodo Payments dashboard, navigate to <b>Webhooks ‚Üí + Add Endpoint</b> and expand the integrations dropdown.
  <Frame>
    <img src="/images/integrations/teams.png" alt="Add Endpoint and integrations dropdown" />
  </Frame>
</Step>

<Step title="Select Microsoft Teams">
  Choose the <b>Microsoft Teams</b> integration card.
</Step>

<Step title="Create Teams Webhook">
  In Teams, go to your channel ‚Üí ‚ãØ ‚Üí Connectors ‚Üí Incoming Webhook ‚Üí Configure. Copy the webhook URL.
</Step>

<Step title="Paste Webhook URL">
  Paste the Teams webhook URL into the endpoint configuration.
</Step>

<Step title="Customize Transformation">
  Edit the transformation code to format messages as Adaptive Cards for Teams.
</Step>

<Step title="Test & Create">
  Test with sample payloads and click <b>Create</b> to activate.
</Step>

<Step title="Done!">
  üéâ Your Teams channel will now receive Dodo Payments updates as Adaptive Cards.
</Step>
</Steps>

## Transformation Code Examples

### Basic Payment Card

```javascript payment_card.js icon="js" expandable
function handler(webhook) {
  if (webhook.eventType === "payment.succeeded") {
    const p = webhook.payload.data;
    webhook.payload = {
      type: "message",
      attachments: [{
        contentType: "application/vnd.microsoft.card.adaptive",
        content: {
          type: "AdaptiveCard",
          body: [
            {
              type: "TextBlock",
              text: "‚úÖ Payment Successful",
              weight: "Bolder",
              size: "Medium"
            },
            {
              type: "FactSet",
              facts: [
                { title: "Amount", value: `$${(p.total_amount / 100).toFixed(2)}` },
                { title: "Customer", value: p.customer.email },
                { title: "Payment ID", value: p.payment_id }
              ]
            }
          ]
        }
      }]
    };
  }
  return webhook;
}
```

### Subscription Management

```javascript subscription_card.js icon="js" expandable
function handler(webhook) {
  const s = webhook.payload.data;
  switch (webhook.eventType) {
    case "subscription.active":
      webhook.payload = {
        type: "message",
        attachments: [{
          contentType: "application/vnd.microsoft.card.adaptive",
          content: {
            type: "AdaptiveCard",
            body: [
              {
                type: "TextBlock",
                text: "üìÑ Subscription Activated",
                weight: "Bolder",
                color: "Good"
              },
              {
                type: "FactSet",
                facts: [
                  { title: "Customer", value: s.customer.email },
                  { title: "Product", value: s.product_id },
                  { title: "Amount", value: `$${(s.recurring_pre_tax_amount / 100).toFixed(2)}/${s.payment_frequency_interval}` },
                  { title: "Next Billing", value: new Date(s.next_billing_date).toLocaleDateString() }
                ]
              }
            ]
          }
        }]
      };
      break;
    case "subscription.cancelled":
      webhook.payload = {
        type: "message",
        attachments: [{
          contentType: "application/vnd.microsoft.card.adaptive",
          content: {
            type: "AdaptiveCard",
            body: [
              {
                type: "TextBlock",
                text: "‚ö†Ô∏è Subscription Cancelled",
                weight: "Bolder",
                color: "Warning"
              },
              {
                type: "FactSet",
                facts: [
                  { title: "Customer", value: s.customer.email },
                  { title: "Product", value: s.product_id },
                  { title: "Cancelled At", value: new Date(s.cancelled_at).toLocaleDateString() }
                ]
              }
            ]
          }
        }]
      };
      break;
  }
  return webhook;
}
```

### Dispute Alerts

```javascript dispute_card.js icon="js" expandable
function handler(webhook) {
  if (webhook.eventType.startsWith("dispute.")) {
    const d = webhook.payload.data;
    const color = d.dispute_status === "won" ? "Good" : d.dispute_status === "lost" ? "Attention" : "Warning";
    const title = d.dispute_status === "won" ? "üèÜ Dispute Won" : d.dispute_status === "lost" ? "‚ùå Dispute Lost" : "üö® Dispute Update";
    
    webhook.payload = {
      type: "message",
      attachments: [{
        contentType: "application/vnd.microsoft.card.adaptive",
        content: {
          type: "AdaptiveCard",
          body: [
            {
              type: "TextBlock",
              text: title,
              weight: "Bolder",
              color: color
            },
            {
              type: "FactSet",
              facts: [
                { title: "Payment ID", value: d.payment_id },
                { title: "Amount", value: `$${(d.amount / 100).toFixed(2)}` },
                { title: "Status", value: d.dispute_status },
                { title: "Stage", value: d.dispute_stage }
              ]
            }
          ]
        }
      }]
    };
  }
  return webhook;
}
```

## Tips

- Use Adaptive Cards for rich, interactive formatting
- Choose appropriate colors: Good (green), Warning (yellow), Attention (red)
- Keep fact sets concise and readable
- Test with Teams webhook tester before deploying

## Troubleshooting

<AccordionGroup>
<Accordion title="No messages in Teams">
- Verify the webhook URL is correct and active
- Check that the transformation returns valid Adaptive Card JSON
- Ensure the webhook has permission to post in the channel
</Accordion>

<Accordion title="Card formatting issues">
- Validate Adaptive Card schema in Teams webhook tester
- Check that all required fields are present
- Ensure color values are valid (Good, Warning, Attention, Default)
</Accordion>
</AccordionGroup>